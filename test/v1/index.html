<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>簡易繪圖板</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 確保 body 和 html 佔滿整個視窗高度，以便置中 */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif; /* 使用較美觀的字體 */
        }
        /* 自訂控制項的樣式，使其在行動裝置上有更好的觸控體驗 */
        .control-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 10px;
        }
        .control-item label {
            margin-bottom: 5px;
            font-size: 0.875rem;
            color: #4a5568;
        }
        input[type="color"] {
            -webkit-appearance: none;
            width: 50px;
            height: 50px;
            border: none;
            padding: 0;
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        input[type="color"]::-webkit-color-swatch {
            border: 2px solid #e2e8f0;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center">

    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-2xl w-full max-w-4xl m-4">
        <!-- 繪圖區域 -->
        <canvas id="draw" class="border-2 border-gray-200 rounded-xl w-full cursor-crosshair"></canvas>

        <!-- 控制項區域 -->
        <div id="controls" class="mt-6 flex flex-wrap items-center justify-center gap-4">
            <div class="control-item">
                <label for="color">顏色</label>
                <input type="color" id="color" value="#000000">
            </div>

            <div class="control-item flex-grow max-w-xs">
                <label for="size">畫筆大小</label>
                <input type="range" id="size" min="1" max="100" value="10" class="w-full">
            </div>

            <button id="clear" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-300">
                清除畫布
            </button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('draw');
        const ctx = canvas.getContext('2d');

        const colorPicker = document.getElementById('color');
        const sizeSlider = document.getElementById('size');
        const clearButton = document.getElementById('clear');

        // --- 狀態變數 ---
        // isDrawing 用來判斷滑鼠是否正在按下的狀態
        let isDrawing = false;
        // lastX 和 lastY 用來儲存上一個點的座標
        let lastX = 0;
        let lastY = 0;

        // --- 核心繪圖函式 ---
        function draw(e) {
            // 如果滑鼠沒有按下，就直接返回，不進行繪圖
            if (!isDrawing) return;

            // 設置畫筆樣式
            ctx.strokeStyle = colorPicker.value;
            ctx.lineWidth = sizeSlider.value;
            ctx.lineJoin = 'round'; // 線條交接處的樣式
            ctx.lineCap = 'round';   // 線條末端的樣式

            // 開始繪圖路徑
            ctx.beginPath();
            // 移動到上一個點
            ctx.moveTo(lastX, lastY);
            // 畫一條線到當前滑鼠的位置
            // e.offsetX 和 e.offsetY 可以取得滑鼠相對於 canvas 左上角的位置
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke(); // 執行繪圖

            // 更新上一個點的座標
            [lastX, lastY] = [e.offsetX, e.offsetY];
        }

        // --- 事件監聽器 ---

        // 當滑鼠在 canvas 上按下時
        canvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            // 更新起始點座標
            [lastX, lastY] = [e.offsetX, e.offsetY];
        });
        
        // 當滑鼠在 canvas 上移動時
        canvas.addEventListener('mousemove', draw);

        // 當滑鼠放開時
        canvas.addEventListener('mouseup', () => isDrawing = false);

        // 當滑鼠移出 canvas 範圍時 (避免線條一直畫到外面)
        canvas.addEventListener('mouseout', () => isDrawing = false);

        // 清除按鈕的點擊事件
        clearButton.addEventListener('click', () => {
            // 清除整個 canvas 的內容
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        });

        // --- 響應式設定 ---
        function resizeCanvas() {
            // 儲存當前的繪圖內容，避免縮放時遺失
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            // 讓 canvas 的畫布解析度與其 CSS 顯示的寬高一致
            // 這可以避免繪圖時產生模糊或變形
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            // 將儲存的內容重新繪製回去
            ctx.putImageData(imageData, 0, 0);
        }

        // 頁面載入時和視窗大小改變時，都重新設定 canvas 大小
        window.addEventListener('load', resizeCanvas);
        window.addEventListener('resize', resizeCanvas);

    </script>
</body>
</html>
